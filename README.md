# Задание на курсовую работу
---

1. Анализ предметной области. Постановка задачи.

    1.1. Описание предметной области и функции решаемых задач.

    1.2. Перечень входных данных.

    1.3. Перечень выходных данных

    1.4. Ограничения предметной области (если таковые имеются).

    1.5. Взаимодействие с другими программами.

3. Инфологическая (концептуальная) модель базы данных.

    2.1. Выделение информационных объектов.

    2.2. Определение атрибутов объектов.

    2.3. Определение отношений и мощности отношений между объектами.

    2.4. Построение концептуальной модели.

4. Логическая структура БД.

5. Физическая структура базы данных.

6. Реализация проекта в среде конкретной СУБД.

    5.1. Создание таблиц.

    5.2. Создание запросов.

    5.3. Разработка интерфейса.

    5.4. Назначение прав доступа.

    5.5. Создание индексов.

    5.6. Разработка стратегии резервного копирования базы данных


   [мине](https://www.bibliofond.ru/view.aspx?id=863432)
   [мине2](https://github.com/Evgeny121231/Bush_Kyrsova)
[мине2](https://gist.github.com/Jekins/2bf2d0638163f1294637)
   # Содержание
---
## Описание предметной области 
Эта база данных предназначена для управления информацией в системе, которая обслуживает клиентов, заказы, сотрудников и услуги. Она используется для эффективного хранения данных и управления процессами в компании, которая предоставляет различные услуги своим клиентам. Система включает в себя несколько ключевых компонентов, таких как клиенты, заказы, сотрудники и услуги, а также механизмы управления ими.

**Цель работы** заключается в разработке базы данных для инвентаризации товаров на предприятии, которая обеспечит эффективное управление товарными запасами, автоматизацию учётных процессов и поддержку принятия решений. В рамках работы предполагается:  

1. **Создание структуры базы данных**:  
   Разработать схему БД, отражающую ключевые сущности предметной области: товары, поставщики, заказы, склады, категории товаров, перемещения и списания. Обеспечить целостность данных за счёт нормализации таблиц, установки связей и ограничений.  
2. **Реализация функционала для ввода и обновления данных**:  
   Создать механизмы для добавления новых товаров, регистрации поставок, корректировки остатков на складах, учёта продаж и списания брака. Интегрировать интерфейсы, упрощающие ввод данных для сотрудников.  
3. **Разработка аналитических представлений и запросов**:  
   Реализовать отчёты по остаткам товаров, динамике продаж, сезонному спросу и эффективности поставщиков. Настроить автоматическое формирование предупреждений о критическом уровне запасов или просроченных товарах.  
4. **Обеспечение безопасности и управления доступом**:  
   Внедрить ролевую модель (администратор, поставщиков, клиентов) с разграничением прав. Защитить данные от несанкционированного доступа, настроить резервное копирование и аудит изменений.  
5. **Анализ данных для оптимизации бизнес-процессов**:  
   Провести анализ товарооборота, выявить неликвидные запасы, определить оптимальные объёмы закупок. Использовать данные для сокращения логистических издержек и минимизации потерь.  
6. **Документирование системы**:  
   Подготовить техническую документацию (ER-диаграммы, описание таблиц, SQL-скрипты) и руководство пользователя с примерами работы в системе.  

Таким образом, разработанная база данных станет инструментом для автоматизации инвентаризации, повысит точность учёта товаров и позволит предприятию оперативно реагировать на изменения рыночного спроса.

Для достижения поставленной цели необходимо решить следующие задачи:  

1. **Анализировать предметную область управления клиентами, заказами и услугами**  
   Изучить текущие методы обработки заказов и взаимодействия с клиентами. Выявить потребности пользователей (администраторов, клиентов, сотрудников) и определить ключевые данные для хранения:
- Клиенты: контактные данные, история заказов, персональные скидки.
- Заказы: информация о заказчике, сотруднике-исполнителе, услугах, статусе заказа.
- Сотрудники: должность, контакты, обработанные заказы.
- Услуги: перечень оказываемых услуг, их стоимость, описание.
Важно выявить проблемы текущей системы: неэффективность ручного учёта заказов, сложность отслеживания выполненных услуг, необходимость в аналитике и автоматизации отчетности.

2. **Проектировать структуру базы данных**  
Определить основные сущности и их атрибуты:
-Пользователи (users): имя, email, пароль, роль (администратор или клиент).
- Клиенты (clients): ФИО, контактные данные, дата регистрации.
- Заказы (orders): клиент, сотрудник, дата заказа, сумма, статус (новый, в работе, выполнен).
- Сотрудники (employees): ФИО, контакты, должность.
- Услуги (services): название, описание, стоимость.
- 
Установить связи между таблицами:
- Один клиент может иметь несколько заказов (1:N).
- Один заказ может включать несколько услуг (M:N).
- Один сотрудник может быть назначен на несколько заказов (1:N).
- 
Определить ограничения целостности:
- Уникальность email-адресов пользователей.
- Нельзя удалить сотрудника, если он связан с заказами.
- Контроль за отрицательными значениями в сумме заказа.

3. **Выбрать и обосновать СУБД**  
   Сравнить PostgreSQL, MySQL и SQLite с учётом требований предприятия: поддержка транзакций, масштабируемость, безопасность. Выбрать PostgreSQL, так как она обеспечивает надежность, поддержку JSON для метаданных товаров и совместимость с Python-библиотеками.  

4. **Реализовать структуру базы данных**  
Написать SQL-скрипты для создания таблиц и индексов.

6. **Заполнить базу тестовыми данными**  
  Добавить демо-записи для проверки работы системы:
- Клиенты: 4 записей с разными именами и контактами.
- Сотрудники: 4 сотрудников с разными ролями.
- Услуги: 4 различных услуг с разными ценами.
- Заказы: 4 тестовые заказы с различными статусами.

6. **Разработать приложение на visual studio**  
   Создать интерфейс для:  
   - Регистрации клиентов и сотрудников.
   - Просмотра списка клиентов, заказов и услуг.
   - Добавления и редактирования заказов.

Созданная система позволяет автоматизировать управление заказами, клиентами и услугами, повысить эффективность бизнеса и обеспечить удобный доступ к информации.


## Функции решаемых задач
Создание базы данных для фотоцентра может включать множество различных функций и задач. Вот несколько ключевых функций, которые могут быть реализованы в базе данных фотоцентра:
1. Управление клиентами

    Регистрация клиентов: Возможность добавления новых клиентов с их контактной информацией.
    Обновление информации о клиентах: Изменение контактных данных, адресов и т.д.
    Просмотр истории заказов: Клиенты могут видеть свои предыдущие заказы и статусы.

2. Управление заказами

    Создание заказов: Возможность оформления новых заказов на фотосъемку, печать фотографий и т.д.
    Обновление статуса заказа: Изменение статуса заказа (например, "в обработке", "завершен", "отменен").
    Отслеживание сроков выполнения: Указание сроков выполнения заказов и уведомление клиентов о готовности.

3. Управление услугами

    Добавление и обновление услуг: Возможность добавления новых услуг (например, фотосъемка, печать, ретушь) и их изменения.
    Ценовая политика: Установка цен на различные услуги и акции.

4. Управление персоналом

    Регистрация сотрудников: Добавление сотрудников с их ролями и контактной информацией.
    Управление рабочими графиками: Учет рабочего времени сотрудников и распределение задач.

   
## Перечень входных данных
1. Данные о клиентах: Фамилия, имя, email, телефон, адрес, дата регистрации.
2. Данные о сотрудниках: Фамилия, имя, email, телефон, должность, роль (например, администратор).
3. Данные о заказах: Дата заказа, сумма, клиент, сотрудник, услуги.
4. Данные об услугах: Название услуги, описание, стоимость.

## Перечень выходных данных
1. Список клиентов: Имя, фамилия, контактные данные, количество заказов.
2. Список сотрудников: Имя, фамилия, должность, количество обработанных заказов.
4. Список заказов: Дата, клиент, сотрудник, статус, сумма.
5. Отчеты по услугам: Количество заказанных услуг, доход от каждой услуги.
      
## Ограничения предметной области

1. Ограничения на сущности:
    - Клиенты: Каждый клиент должен иметь уникальный идентификатор (например, номер телефона или email). Не допускается наличие двух клиентов с одинаковыми контактными данными.
    - Заказы: Каждый заказ должен быть связан с конкретным клиентом и содержать уникальный номер заказа. Не допускается создание заказа без указания клиента.
    - Фотографии: Каждая фотография должна иметь уникальный идентификатор и быть связана с конкретным заказом.

2. Ограничения на атрибуты:
    - Дата заказа: Дата заказа не может быть в будущем.
    - Статус заказа: Статус заказа должен принимать только определенные значения (например, "в обработке", "завершен", "отменен").
    - Формат фотографий: Форматы фотографий должны соответствовать заранее определенному списку (например, JPEG, PNG).

3. Ограничения на связи:
    - Связь между клиентами и заказами: Один клиент может иметь несколько заказов, но каждый заказ должен принадлежать только одному клиенту (отношение "один ко многим").
    - Связь между заказами и фотографиями: Один заказ может включать несколько фотографий, но каждая фотография должна принадлежать только одному заказу.

4. Ограничения на бизнес-правила:
    - Оплата: Заказ должен быть оплачен до его выполнения. Не допускается выполнение заказа без подтверждения оплаты.
    - Сроки выполнения: Срок выполнения заказа должен быть заранее определен и не может превышать установленный лимит (например, 14 дней).

5. Ограничения на целостность данных:
    - Ссылочная целостность: Не допускается удаление клиента, если у него есть активные заказы. Аналогично, не допускается удаление заказа, если он содержит фотографии.
    - Проверка уникальности: Необходимо обеспечить уникальность определенных атрибутов, таких как email клиента или номер заказа.

## Взаимодействие с другими программами
Система должна интегрироваться с:

- Электронной почтой для отправки уведомлений о новых заказах, статусах заказов и других оповещений.
- Системами платежей для получения информации о статусах оплат.
- Системами отчетности и аналитики, для формирования графиков и таблиц.

# Инфологическая (концептуальная) модель базы данных.
## Выделение информационных объектов и определение атрибутов.
Описание свойств таблицы «Заказ» 
| Имя поля | Ключевое поле | Тип данных | Обязательное поле |
|----------|---------------|------------|-------------------|
| id заказа | да            | Числовой   |  да               |
| id клиента | нет        | Числовой      | да |
| id услуги | нет        | Числовой      | да |
| Статус | нет | Текстовый | Да | 
| Дата |Нет |Дата/время |Да |

Описание свойств таблицы «Клиент»
| Имя поля | Ключевое поле | Тип данных | Обязательное поле |
|---------|---------|--------|---------------|
| id клиента | Да | Числовой | Да |
| ФИО | Нет | Текстовый | Да |
| e=mail | Нет | Текстовый | Да |
| Телефон | Нет | Числовой | Да |

Описание свойств таблицы «Сотрудник»
| Имя поля | Ключевое поле | Тип данных | Обязательное поле |
|------------|-----------|----------|--------------|
|id сотрудника |Да |Числовой |Да |
|ФИО |Нет |Текстовый |Да |
| e=mail | Нет | Текстовый | Да |
| Телефон | Нет | Числовой | Да |

Описание свойств таблицы «Услуги» 
| Имя поля | Ключевое поле | Тип данных | Обязательное поле |
|------------|-----------|----------|--------------|
|id услуги |Да |Числовой |Да |
|Вид |Нет |Текстовый |Да |
|Цена |Нет |Денежный |Да |

## Определение отношений и мощности отношений между объектами.
![image](https://github.com/user-attachments/assets/892d5796-94e3-4f1e-8657-37b8dc1cbec5)
## Построение концептуальной модели.
![image](https://github.com/user-attachments/assets/17d38073-16ac-457a-8504-b2ecc05255db)
# Логическая структура БД.
![image](https://github.com/user-attachments/assets/6d38225a-6af6-4a8b-9348-3239d3a92308)

## Создание таблиц
```
CREATE TABLE klienti
(
    id_kli int PRIMARY KEY not null,
    familia CHARACTER VARYING(50) not null,
    ima CHARACTER VARYING(50) not null,
    otchestvo CHARACTER VARYING(50) not null,
    email CHARACTER VARYING(50) not null,
    phone CHARACTER VARYING(20) not null
);
CREATE TABLE zakazi
(
    id_zakaza int PRIMARY KEY not null,
	foreign key id_ycl int not null,
    foreign key id_kli int not null,
	foreign key id_sotrydnika int not null, 
    datee date not null,
    status CHARACTER VARYING(50) not null
   
);
CREATE TABLE sotrydniki
(
    id_sotrydnika int PRIMARY KEY not null,
    familia CHARACTER VARYING(50) not null,
    ima CHARACTER VARYING(50) not null,
    otchestvo CHARACTER VARYING(50) not null,
    datee date not null,
    email CHARACTER VARYING(50) not null,
    phone CHARACTER VARYING(20) not null
);
CREATE TABLE yclygi
(
    id_ycl int PRIMARY KEY not null,
    price money not null,
    name CHARACTER VARYING(50) not null
);
CREATE TABLE user
(
    id int PRIMARY KEY not null,
    username  CHARACTER VARYING(50) not null,
    email CHARACTER VARYING(100) not null,
    password_hash CHARACTER VARYING(200),
    ia_admin bool
);
```

## Создание запросов
Получить всех пользователей из базы данных
```
SELECT * FROM users;
```
Добавить нового пользователя 
```
INSERT INTO users (username, email, password_hash, is_admin) 
VALUES ('new_user', 'new_user@example.com', 'hashed_password', FALSE);
```
Удалить пользователя
```
DELETE FROM users
WHERE id = 1;  -- Замените 1 на фактический ID пользователя
```
Получить все заказы и информацию о клиентах
```
SELECT o.*, c.first_name, c.last_name 
FROM orders o
JOIN clients c ON o.client_id = c.id;
```
Добавить новый заказ
```
INSERT INTO orders (client_id, employee_id, order_date, total_amount)
VALUES (1, 2, CURRENT_DATE, 100.00);  -- Замените client_id и employee_id на реальные ID
```
Получить всех сотрудников, являющихся администраторами
```
SELECT * FROM employees
WHERE is_admin = TRUE;
```
Получить все предоставляемые услуги
```
SELECT * FROM services;
```
Удалить услугу
```
DELETE FROM services
WHERE service_id = 1;  -- Замените на фактический ID услуги
```
## Разработка интерфейса.
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-02.png)
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-08.png)
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-20.png)
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-20.png|)
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-24.png)
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-28.png)
![image](https://github.com/SVK-314/pop/blob/main/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20%D0%BE%D1%82%202025-03-15%2012-02-31.png)


## Разработка стратегии резервного копирования базы данных

Для защиты данных от сбоев и потерь необходимо разработать стратегию регулярного резервного копирования. Для PostgreSQL основными методами являются:

- **Ежедневное логическое резервное копирование с помощью pg_dump** — позволяет создавать бэкап базы данных в формате SQL. Эти резервные копии можно хранить на удаленном сервере или в облаке.

Пример ежедневного резервного копирования:
```
pg_dump -U inventorybd  -F c -b -v -f "/backups/backup_$(date +\%Y\%m\%d).backup" inventorybd 
```
- **Полное физическое резервное копирование раз в неделю с использованием pg_basebackup** — особенно полезно для больших объемов данных, так как обеспечивает быстрое восстановление базы данных.

Пример команды:
```
pg_basebackup -U inventorybd  -D /path/to/backup -Ft -z -P
```
- **Проверка и тестирование восстановлений** — резервное копирование должно регулярно тестироваться на восстановление, чтобы убедиться в работоспособности резервных копий. Это критически важно для обеспечения постоянной доступности и надежности данных.

Стратегия резервного копирования должна включать хранение нескольких копий данных на случай различных инцидентов, таких как сбой оборудования или ошибка администратора.

